<!doctype html>
<html class="no-js" lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>
        
        NathanCHEN
        
    </title>
    
    
    <link href="atom.xml" rel="alternate" title="NathanCHEN" type="application/atom+xml">
    <link rel="stylesheet" href="asset/css/foundation.min.css"/>
    <link rel="stylesheet" href="asset/css/docs.css"/>
    <link rel="stylesheet" href="asset/css/my.css"/>
    <script src="asset/js/vendor/modernizr.js"></script>
    <script src="asset/js/vendor/jquery.js"></script>
    <script src="asset/highlightjs/highlight.pack.js"></script>
    <link href="asset/highlightjs/styles/github.css" media="screen, projection" rel="stylesheet" type="text/css">
    <script>hljs.initHighlightingOnLoad();</script>

</head>
<body class="antialiased hide-extras">

<div class="marketing off-canvas-wrap" data-offcanvas>
    <div class="inner-wrap">


        <nav class="top-bar docs-bar hide-for-small" data-topbar>


            <section class="top-bar-section">
                <div class="row">
                    <div style="position: relative;width:100%;">
                        <div style="position: absolute; width:100%;">
                            <ul id="main-menu" class="left">
                                <li id="menu_item_index"><a href="index.html">HOME</a></li>
                                <li id="menu_item_archives"><a href="archives.html">Archives</a></li>
                                <li id="menu_item_about"><a href="about.html">ABOUT</a></li>
                            </ul>

                            <ul class="right" id="search-wrap">
                                <li>
                                    <form target="_blank" action="http://google.com/search" method="get">
                                        <input type="hidden" name="q" value="site:nathanchen.github.io"/>
                                        <input tabindex="1" type="search" name="q" placeholder="Search"/>
                                    </form>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

        </nav>

        <nav class="tab-bar show-for-small">
            <a href="javascript:void(0)" class="left-off-canvas-toggle menu-icon">
                <span> &nbsp; NathanCHEN</span>
            </a>
        </nav>

        <aside class="left-off-canvas-menu">
            <ul class="off-canvas-list">

                <li><a href="index.html">HOME</a></li>
                <li><a href="archives.html">Archives</a></li>
                <li><a href="about.html">ABOUT</a></li>

                <li><label>Categories</label></li>

                
                <li><a href="Java.html">Java</a></li>
                
                <li><a href="JavaScript.html">JavaScript</a></li>
                
                <li><a href="Ngnix.html">Ngnix</a></li>
                
                <li><a href="tomcat.html">tomcat</a></li>
                
                <li><a href="spring.html">spring</a></li>
                
                <li><a href="RabbitMQ.html">RabbitMQ</a></li>
                
                <li><a href="ELK.html">ELK</a></li>
                
                <li><a href="TCP/IP.html">TCP/IP</a></li>
                
                <li><a href="%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB.html">源码阅读</a></li>
                
                <li><a href="others.html">others</a></li>
                
                <li><a href="%E6%95%B0%E6%8D%AE%E5%BA%93.html">数据库</a></li>
                
                <li><a href="PAXOS.html">PAXOS</a></li>
                
                <li><a href="%E6%B7%B1%E5%85%A5%E5%88%86%E6%9E%90Java%20Web%E6%8A%80%E6%9C%AF%E5%86%85%E5%B9%95.html">深入分析Java Web技术内幕</a></li>
                

            </ul>
        </aside>

        <a class="exit-off-canvas" href="#"></a>


        <section id="main-content" role="main" class="scroll-container">
 <script type="text/javascript">
    $(function () {
        $('#menu_item_index').addClass('is_active');
    });
</script>
<div class="row">
    <div class="large-8 medium-8 columns">
        <div class="markdown-body home-categories">
            
            <div class="article">
                <a class="clearlink" href="14457412435478.html">
                    
                    <h1>---</h1>

                    <div class="a-content">
                        
                        <div class="a-content-text">
                            
                            <p>layout: post<br/>
title: <q>Database Systems(1)</q><br/>
category: </p>

<h2 id="toc_0">tags: [<q>读书</q>]</h2>

<p>{% include JB/setup %}</p>

<ul>
<li><p>Database: Collection of data central to some enterprise/ organisation; essential to operation of enterprise; an asset in its own right: historial data can guide enterprise strtegy, of interest to other enterprises; database is persistent; all qualfied users have access to the same data for use in a variety of activities.</p></li>
<li><p>A database management system is a program that manages a database: stores the database on some mass storage providing fail safety(backup/ recovery); supports a high-level access language(SQL); provdes transaction management to guarantee correct concurrent access to shared data.</p></li>
<li><p>Disadvantages of File processing:</p>

<p>1) Program-data dependence: all programs contain full descriptions of each data file they use</p>

<p>2) Data Redundancy: different systems/ programs have separate copies of the same data; no centralized control of data</p>

<p>3) Limited data sharing: required data in several, potentially incompatible files.</p>

<p>4) Excessive progrmam maintenance</p></li>
<li><p>Advantages of Database:</p>

<p>1) Program-data independence: metadata stored in DBMS, so applications dont need to worry about data formats; results in reduced application development time, increased maintenance productivity and efficient access.</p>

<p>2) minimal data redundancy: leads to increased data integrity/ consistency</p>

<p>3) Improved Data Sharing: different users get different views of the data; efficient concurrent access</p>

<p>4) Enforcement of standards: all data access is done in the same way</p>

<p>5) Improved data quality: integrity constraints, data validation rules</p>

<p>6) Better data accessibility/ responsiveness: use of standard data query language(SQL)</p>

<p>7) security, backup/recovery, concurrency</p></li>
<li><p>Relational Databases</p>

<ul>
<li>Stores data as rows with multiple attributes</li>
<li>Rows of the same format(&#39;type&#39;) form a table</li>
<li>A relational database is a collection of such tables (which typically are related to each other by key attributes)</li>
</ul></li>
<li><p>What is a transaction: When an event in the real world changes the state of the enterprise, a transaction is executed to cause the corresponding change in the database state.</p></li>
<li><p>DB system requirements:<br/>
1) High Availability: online -&gt; must be operational while enterprise is functioning<br/>
2) High Reliability: correctly tracks state, does not loose data, controlled concurrency<br/>
3) High Throughput: many users -&gt; many transactions per second<br/>
4) Low Response Time: on line -&gt; users are waiting<br/>
5) Long lifetime: complex systems are not easily replaced<br/>
6) Security: sensitive information must be carefully protected since system is accessible to many users.</p></li>
<li><p>Data model: a collection of concepts for describing data</p></li>
<li><p>Schema: a description of a particular collection of data at some abstraction level, using a given data model.</p></li>
<li><p>Relational data model:</p>

<p>relation, basically a table with rows and columns</p>

<p>schema, which describes the columns or fields</p></li>
<li><p>Relation is a set of tuples (is a named, two-dimensional table of data)</p>

<p>1) tuple ordering immaterial<br/>
2) No duplicates<br/>
3) Cardinality of relation = number of tuples per entity</p></li>
<li><p>All tuples in a relation have the same structure; constructed from the same set of attributes.</p>

<p>1) Arity of relation = number of attributes<br/>
2) attributes are named (ordering is immaterial)</p></li>
<li><p>Not all tables qualify as a relation</p>

<p>1) Every relation must have a unique name<br/>
2) Attributes in tables must have unique names<br/>
3) Every attribute value is atomic. The range of allowed values of an attribute is called its domain<br/>
4) The order of the columns is irrellevant<br/>
5) Every row is unique (cant have two rows with exactly the same values for all their fields)<br/>
6) The order of the rows is irrelevant</p></li>
<li><p>A relation R(表格中具体的数据) has a relation schema（表格的输入格式）, which specifies name of relation, and name and data type of each attribute</p></li>
<li><p>Relation schema:</p>

<p>Students(sid: string, name: string, login: string, addr: string, gender: char)</p></li>
<li><p>Relation: <br/>
    R = { (Jones, Main, Sydney),<br/><br/>
         (Smith, North, Perth), <br/>
         (Curry, North, Brisbane), <br/>
         (Lindsay, Park, Sydney) } </p></li>
<li><p>A relation instance: a set of tuples(table) for a schema</p></li>
</ul>

<h1 id="toc_1">rows = cardinality</h1>

<h1 id="toc_2">fields = degree (or arity) of a relation</h1>

<ul>
<li><p>First Normal Form (<strong>1NF</strong>) is the restriction of atomic attributes</p></li>
<li><p>Relational database management system(RDBMS) allows duplicate rows</p>

<p>In a SQL-based RDBMS, it is possible to insert a row where every attribute has the same value as an existing row. The table will then contain two identical rows. </p></li>
<li><p>RDBMS allows a special <q>null</q> value in a column to represent facts that are not relevant, or not yet known.</p></li>
<li><p><strong>It is very dangerous to instead use an ordinary value with special meaning</strong>: Eg if salary = -1 is used for <q>unknown</q>, then averages wont be sensible</p></li>
<li><p>keys are special attributes that serve two main purposes:</p>

<p>1) Primary keys are unique, minimal identifiers of the relation in question. <br/>
2) Foreign keys are identifiers that enable a dependent relation (on the many side of a relationship) to refer to its parent relation (on the one side of the relationship)</p></li>
<li><p>Keys can be simple (a single attribute) or composite (more than one attribute)</p></li>
<li><p>Keys usually are used as indices to speed up the response to user queries</p></li>
<li><p>Possibly many candidate keys (specified using UNIQUE), one of which is chosen as the primary key</p></li>
<li><p>Foreign key: set of attributes in a relation that is used to &#39;refer&#39; to a tuple in a parent relation</p></li>
<li><p>Referential Integrity: for each tuple in the referring relation whose foreign key value is a, there must be a tuple in the referred relation whose primary key value is also a.</p></li>
<li><p>CREATE TABLE Enrolled ( sid INTEGER, ucode CHAR(8), semester VARCHAR, </p>

<p>CONSTRAINT Enrolled_FK1 FOREIGN KEY (sid) REFERENCES Student, </p>

<p>CONSTRAINT Enrolled_FK2 FOREIGN KEY (ucode) REFERENCES UoS, </p>

<p>CONSTRAINT Enrolled_PK  PRIMARY KEY (sid,ucode)  </p>

<p>);</p></li>
<li><p>Data Structure: A relational database is a set of relations (tables) with tuples (rows) and fields (columns) - a simple and consistent structure</p></li>
<li><p>The union of the corresponding relational schemata is the relational database schema</p></li>
<li><p>Data manipulation: powerful operators to manipulate the data stored in relations</p></li>
<li><p>Data Integrity: facilities to specify a variety of rules to maintain the integrity of data when it is manipulated.</p></li>
<li><p>Integrity Constraint (IC): condition that must be true for any instance of the database.</p>

<p>ICs can be declared in the schema. They are specified when schema is defined. All declared ICs are checked whenever relations are modified.</p></li>
<li><p>A legal instance of a relation is one that satisfies all specified ICs. If ICs are declared, DBMS will not allow illegal instances.</p></li>
<li><p>Logical schema: </p>

<ul>
<li>Student(sid:integer, name:string, login:string, bdate: date, sex:char) </li>
<li>UoS(ucode:string, cname:string, credits: integer) </li>
<li>Enrolled(sid:integer, ucode :string, semester: integer, grade:string) </li>
</ul></li>
<li><p>Physical Schema: </p>

<ul>
<li>describes details of how data is stored:<br/></li>
<li>E.g. relations stored as unordered files </li>
<li>Index on first column of Students </li>
<li>non-database applications typically have only on a physical schema</li>
</ul></li>
<li><p>External Schema (view) </p>

<ul>
<li>UoS_info(ucode :string, enrolment: integer) </li>
</ul></li>
<li><p>A view is a virtual relation, but we store a definition, rather than a set of tuples. A mechanism to hide data from the view of certain users.Views can be used to present necessary information, while hiding details in underlying relations. </p></li>
<li><p>Entity: a person, place, object, event, or concept about which you want to gather and store data</p></li>
<li><p>Entity type (also: entity set): a collection of entities that share common properties or characteristics, which is described by a set of attributes</p></li>
<li><p>Attribute: describe one aspect of an entity type</p></li>
<li><p>domain: possible values of an attribute</p></li>
<li><p>key: minimal set of attributes that uniquely identifies an entity in the set</p></li>
<li><p>Relationship: relates two or more entities</p></li>
<li><p><strong>number of entities is also known as the degree of the relationship</strong></p></li>
<li><p>relation (relational model): set of tuples</p>

<p>relationship (E-R model): describes relationship between entities</p>

<p>Both entity sets and relationship sets (E-R model) may be represented as relations (in the relational model)</p></li>
<li><p><strong>Weak entity type: an entity type that does not have a primary key</strong>.</p>

<p>1) can be seen as an exclusive &#39;part-of&#39; relationship</p>

<p>2) its existence depends on the existence of one or more identifying entity types</p>

<p>3) it must relate to the identifying entity set via a total, one-to-many identifying relationship type from the identifying to the weak entity set</p>

<p>Eg: child from parents, payment of a loan</p></li>
<li><p>The discriminator (or partial key) of a weak entity type is the set of attributes that distinguishes among all the entities of a weak entity type related to the same owning entity</p></li>
<li><p>The most important requirement is adequacy: that the design should allow representing all the important facts about the design</p></li>
<li><p>If a design is adequate, then we seek to avoid redundancy in the data</p></li>
<li><p>Redundant data is where the same information is repeated in several places in the db</p></li>
<li><p>Redundancy is at the root of several problems associated with relational schemas:</p>

<p>1) Insertion Anomaly: Adding new rows forces user to create duplicate data or to use null value</p>

<p>2) Deletion Anomaly: Deleting rows may causes a loss of data that would be needed for other future rows.</p>

<p>3) Update Anomaly: Changing data in a row forces changes to other rows because of duplication</p></li>
<li><p>To say a table relation, it should contain unique rows and no multivalued attributes.</p></li>
<li><p>Functional Dependency: the value of one attribute determines the value of another attribute</p></li>
<li><p>FDs must be identified based on the semantics of an application</p></li>
<li><p><strong>A relation R is in First Normal Form(1NF) if the domains of all attributes of R are atomic</strong> （所有元素都是不能拆分的）</p></li>
<li><p>Domain is atomic if its elements are considered to be indivisible units; Examples of non-atomic domains: multivalued attributes, composite attributes</p></li>
<li><p><strong>Second Normal Form (2NF): 1NF + every non-key attribute is fully functionally dependent on the primary key, this means no partial dependencies, no FD x -&gt; y where x is a strict subset of some key（1NF + 所有非键元素都可以通过主键查找到）</strong></p></li>
<li><p><strong>Third Normal Form (3NF)：2NF + no transitive dependencies (functional dependencies between non-primary-key attributes). No FD of the form x -&gt; y, where x is not a key and y is not at least a subset of a key</strong></p></li>
<li><p>在任何一个关系数据库中，第一范式（1NF）是对关系模式的基本要求，不满足第一范式（1NF）的数据库就不是关系数据库。在第一范式（1NF）中表的每一行只包含一个实例的信息。</p></li>
<li><p>第二范式（2NF）要求数据库表中的每个实例或行必须可以被唯一地区分。<strong>所谓完全依赖是指不能存在仅依赖主关键字一部分的属性</strong>。第二范式就是非主属性非部分依赖于主关键字。</p></li>
<li><p><strong>第三范式（3NF）要求一个数据库表中不包含已在其它表中已包含的非主关键字信息</strong>。</p></li>
</ul>

                            
                        </div>
                    </div>
                </a>

                <div class="read-more clearfix">
                    <div class="more-left left">
                        
                        <span class="date">2015/10/25</span>
                        
                        
                    </div>
                    <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                    </div>
                </div>
            </div>
            <!-- article -->
            
            <div class="article">
                <a class="clearlink" href="14457412435379.html">
                    
                    <h1>---</h1>

                    <div class="a-content">
                        
                        <div class="a-content-text">
                            
                            <p>layout: post<br/>
title: <q>Effective JAVA(2)</q><br/>
category: </p>

<h2 id="toc_0">tags: []</h2>

<p>{% include JB/setup %}</p>

<h2 id="toc_1">Item 3:</h2>

<h3 id="toc_2">Enforce the singleton property with a private constructor or an enum type</h3>

<p>A singleton is simple a class that is instantiated exactly once.</p>

<pre><code>Approach 1:
    public static final Elvis INSTANCE = new Elvis();

Approach 2:
    private static final Elvis INSTANCE = new Elvis();
    public static Elvis getInstance() { return INSTANCE; }
</code></pre>

<p>The main advantage of the public field approach is that the declarations make it clear that the class is a singleton.</p>

<p>One advantage of the factory-method approach is that it gives you the flexibility to change your mind about whether the class should be a singleton without changing its API. The factory method returns the sole instance but could easily be modified to return a unique instance for each thread that invokes it. A second advantage, concerning generic types.</p>

<p>To make a singleton class that is implemented using either of the previous approaches serializable. Otherwise, each time a serialized instance is deserialized, a new instance will be created. To prevent this, add this readResolve method to the Elvis class:</p>

<pre><code>// readResolve method to preserve singleton property
</code></pre>

<p>private Object readResolve() {<br/>
        // Return the one true Elvis and let the garbage collector<br/>
        // take care of the Elvis impersonator.<br/>
       return INSTANCE;<br/>
   }</p>

<p>There is a third approach to implementing singletons. Simply make an enum type with one element:</p>

<pre><code>// Enum singleton - the preferred approach
</code></pre>

<p>public enum Elvis {<br/>
       INSTANCE;<br/>
       public void leaveTheBuilding() { ... }<br/>
   }</p>

<p><strong>A single-element enum type is the best way to implement a singleton.</strong></p>

<h2 id="toc_3">Item 4:</h2>

<h3 id="toc_4">Enforce noninstantiability with a private constructor</h3>

<p>Attempting to enforce noninstantiability by making a class abstract does not work.</p>

<p><strong>A class can be made noninstantiable by including a private constructor</strong>:</p>

<pre><code>// Noninstantiable utility class
</code></pre>

<p>public class UtilityClass <br/>
   {<br/>
       // Suppress default constructor for noninstantiability<br/>
       private UtilityClass() <br/>
       {<br/>
           throw new AssertionError();<br/>
        }<br/>
       ...  // Remainder omitted<br/>
   }</p>

<p>It guarantees that the class will never be instantiated under any circumstances.</p>

<h2 id="toc_5">Item 5:</h2>

<h3 id="toc_6">Avoid creating unnecessary objects</h3>

<p>You can often avoid creating unnecessary objects by using static factory methods. For example, the static factory method Boolean.valueOf(String) is almost always preferable to the constructor Boolean(String)</p>

<p>class Person {<br/>
       private final Date birthDate;<br/>
       // Other fields, methods, and constructor omitted<br/>
       /<br/>
         The starting and ending dates of the baby boom.<br/>
        /<br/>
       private static final Date BOOM_START;<br/>
       private static final Date BOOM_END;</p>

<pre><code>   static {
       Calendar gmtCal =
           Calendar.getInstance(TimeZone.getTimeZone(&quot;GMT&quot;));
       gmtCal.set(1946, Calendar.JANUARY, 1, 0, 0, 0);
       BOOM_START = gmtCal.getTime();
       gmtCal.set(1965, Calendar.JANUARY, 1, 0, 0, 0);
       BOOM_END = gmtCal.getTime();
    }

   public boolean isBabyBoomer() {
       return birthDate.compareTo(BOOM_START) &gt;= 0 &amp;&amp;
              birthDate.compareTo(BOOM_END)   &lt;  0;
    } 
}
</code></pre>

<p>The Person class creates Calendar, TimeZone, and Date instances only once, when it is initialized, instead of creating them every time isBabyBoomer is invoked.</p>

<p><strong>Prefer primitives to boxed primitives, and watch out for unintentional autoboxing.</strong></p>

                            
                        </div>
                    </div>
                </a>

                <div class="read-more clearfix">
                    <div class="more-left left">
                        
                        <span class="date">2015/10/25</span>
                        
                        
                    </div>
                    <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                    </div>
                </div>
            </div>
            <!-- article -->
            
            <div class="article">
                <a class="clearlink" href="14457412435291.html">
                    
                    <h1>---</h1>

                    <div class="a-content">
                        
                        <div class="a-content-text">
                            
                            <p>layout: post<br/>
title: <q>Effective JAVA(1)</q><br/>
category: </p>

<h2 id="toc_0">tags: [<q>读书</q>, <q>Java</q>]</h2>

<p>{% include JB/setup %}</p>

<h2 id="toc_1">Item 1:</h2>

<h3 id="toc_2">Consider static factory methods instead of constructors</h3>

<p><strong>The normal way for a class to allow a client to obtain an instance of itself is to provide a public constructor</strong>. A class can provide a public static factory method, which is simply a static method that returns an instance of the class.</p>

<p>A class can provide its clients with static factory methods instead of, or in addition to, constructors.</p>

<pre><code>One advantage of static factory methods is that, unlike constructors, they have names.
</code></pre>

<p>A static factory with a well-chosen name is easier to use and the resulting client code easier to read. <strong>For example, the constructor BigInteger(int, int, Randon)m which returns a BigInteger that is probably prime, would have been better expressed as a static factory method named BigInteger.probablePrime</strong>.</p>

<h5 id="toc_3">In case where a class seems to require multiple constructors with the same signature, replace the constructors with static factory methods and carefully chosen names to highlight their differences.</h5>

<pre><code>A second advantage of static factory methods is that, unlike constructors, they are not required to create a new object each time they&#39;re invoked.
</code></pre>

<p>The Boolean.valueOf(boolean) method illustrates this technique: it never creates an object. Instance control allows a class to guarantee that it is a singleton or noninstantiable. It allows an immutable class to make the guarantee that no two equal instances exist: a.equals(b) if and only if a==b</p>

<pre><code>A third advantage of static factory methods is that, unlike constructors, they can return an object of any subtype of their return type.

A fourth advantage of static factory methods is that they reduce the verbosity of creating parameterized type instances.

Map&lt;String, List&lt;String&gt;&gt; m = new HashMap&lt;String, List&lt;String&gt;&gt;();

OR

public static &lt;K, V&gt; HashMap&lt;K, V&gt; newInstance(){
    return new HashMap&lt;K, V&gt;();
} 

Map&lt;String, List&lt;String&gt;&gt; m = HashMap.newInstance();
</code></pre>

<h5 id="toc_4">The main disadvantage of providing only static factory methods is that classes without public or protected constructors cannot be subclassed.</h5>

<pre><code>A second disadvantage of static factory methods is that they are not readily distinguishable from other static methods (names of static methods for different classes could be identical).
</code></pre>

<h2 id="toc_5">Item 2:</h2>

<h3 id="toc_6">Consider a builder when faced with many constructor parameters</h3>

<p>Static factories and constructors share a limitation: they do not scale well to large numbers of optional parameters.</p>

<p>Traditionally, programmers have used the telescoping constructor pattern, in which you provide a constructor with only the required parameters, another with a single optional parameter, a third with two optional parameters, and so on.</p>

<pre><code>NutritionFacts cocaCola = new NutritionFacts(240, 8, 100, 0, 35, 27);
</code></pre>

<p>The telecoping constructor pattern works, but it is hard to write client code when there are many parameters, and harder still to read it.</p>

<p>A second alternative when you are faced with many constructor parameters is the JavaBeans pattern, in which you call a parameterless constructor to create the object and then call setter methods to set each required parameter and each optional parameter of interest.</p>

<p>The JavaBeans pattern has serious disadvantages of its own. Because construction is split across multiple calls, a JavaBean may be in an inconsistent state partway through its construction.</p>

<h5 id="toc_7">A third alternative is BUILDER Pattern.</h5>

<p>Instead of making the desired object directly, the client calls a constructor (or static factory) with all of the required parameters and gets a builder object. Then the client calls setter-like methods on the builder object to set each optional parameter of interest. Finally, the client calls a parameterless build method to generate the object, which is immutable.</p>

<pre><code>public class NutritionFacts 
{
    private final int servingSize;
    private final int servings;
    private final int calories;
    private final int fat;
    private final int sodium;
    private final int carbohydrate;

    public static class Builder 
    {
        // Required parameters
        private final int servingSize;
        private final int servings;
        // Optional parameters - initialized to default values
        private int calories      = 0;
        private int fat           = 0;
        private int carbohydrate  = 0;
        private int sodium        = 0;

        public Builder(int servingSize, int servings) 
        {
            this.servingSize = servingSize;
            this.servings    = servings;
        }

        public Builder calories(int val)
        { calories = val;      return this; }

        public Builder fat(int val)
        { fat = val;           return this; }

        public Builder carbohydrate(int val)
        { carbohydrate = val;  return this; }

        public Builder sodium(int val)
        { sodium = val;        return this; }

        public NutritionFacts build() 
        {
            return new NutritionFacts(this);
        } 
    }

    private NutritionFacts(Builder builder) 
    {
        servingSize  = builder.servingSize;
        servings     = builder.servings;
        calories     = builder.calories;
        fat          = builder.fat;
        sodium       = builder.sodium;
        carbohydrate = builder.carbohydrate;
    } 
}
</code></pre>

<h5 id="toc_8">NutritionFacts cocaCola = new NutritionFacts.Builder(240, 8).calories(100).sodium(35).carbohydrate(27).build();</h5>

<h3 id="toc_9">The builder pattern is a good choice when designing classes whose constructor or static factories would have more than a handful of parameters.</h3>

                            
                        </div>
                    </div>
                </a>

                <div class="read-more clearfix">
                    <div class="more-left left">
                        
                        <span class="date">2015/10/25</span>
                        
                        
                    </div>
                    <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                    </div>
                </div>
            </div>
            <!-- article -->
            
            <div class="article">
                <a class="clearlink" href="14457412435200.html">
                    
                    <h1>---</h1>

                    <div class="a-content">
                        
                        <div class="a-content-text">
                            
                            <p>layout: post<br/>
title: <q>Memcached</q><br/>
category: </p>

<h2 id="toc_0">tags: [<q>读文章</q>]</h2>

<p>{% include JB/setup %}</p>

<ul>
<li><p>需要被缓存的对象或数据以key/value对的形式保存在服务器端，每个被缓存的对象或数据都有唯一的标示符key，存取操作通过这个key进行。保存到memcached中的对象或数据放置到内存中，并不会作为文件存储在磁盘上，所以存取速度非常快。</p></li>
<li><p>由于没有对这些对象进行持久性存储，因此在服务器端的服务重启之后存储在内存中的这些数据就会消失。而且当存储的容量达到启动时设定的值时，就自动使用<strong>LRU算法</strong>删除不用的缓存，memcacahed是为缓存而设计的服务器，因此在设计之初没有过多考虑数据的永久性问题。</p></li>
<li><p>Memcached利用Slab Allocation机制来分配和管理内存。</p></li>
<li><p>传统的内存管理方式是：使用完通过malloc非配的内存后通过free来回收内存。这种方式容易产生内存碎片并降低操作系统对内存的管理效率。</p></li>
<li><p>Slab A类location机制不存在这样的问题，它按照预先规定的大小，将分配的内存分割成特定长度的内存块，再把尺寸相同的内存块分成组，这些内存块不会释放，可以重复利用。</p></li>
<li><p>Memcached服务器端保存着一个空闲的内存块列表，<strong>当有数据存入时根据接收到的数据大小，分配一个能存下这个数据的最小内存块</strong>。这种方式有时会造成内存浪费，（例如：<strong>将一个200字节的数据存入一个300字节的内存块中，会有100字节内存被浪费掉，不能使用</strong>）。<strong>避免浪费内存的方法是，预先计算出应用存入的数据大小，或把同一业务类型的数据存入一个Memcached服务器中，确保存入的数据大小相对均匀，这样就可以减少对内存的浪费</strong>。还有一种方法是，在启动时指定“-f”参数，能在某种程度上控制内存组之间的大小差异。在应用中使用memcached时，通常可以不重新设置这个参数，而用默认值“1.25”进行部署。</p></li>
<li><p>缓存一般用来保存一些经常存取的对象或数据，通过缓存来存取对象或数据要比磁盘存取快很多。Memcache是一种内存缓存，把经常存取的对象或数据缓存在内存中，内存中缓存的这些数据通过API的方式被存取，数据就像一张大的HASH表，以key-value对的方式存在。</p></li>
<li><p>Memcache通过缓存经常被存取的对象或数据，来减轻数据库的压力，提高网站的响应速度，构建速度更快的可拓展的Web应用。</p></li>
</ul>

<h5 id="toc_1">Memcache和数据库协作的流程：</h5>

<ul>
<li>检查客户端的请求的数据是否在Memcached中存在，如果存在，直接把请求的数据返回，不再对数据进行任何操作。</li>
<li>如果请求的数据不在Memcache中，就去查询数据库，把从数据库中获取的数据返回给客户端，同时把数据缓存一份到Memcache中。</li>
<li>每次更新数据库（如更新、删除数据库的数据）的同时更行Memcache中的数据，保证Memcache中的数据和数据库中的数据一致。</li>
<li>当分配给Memcache内存空间用完之后，会使用LRU策略加到期失效策略，失效的数据首先被替换掉，然后在替换掉最近未使用的数据。</li>
</ul>

<p>Memcached使用一种<strong>Lazy Expiration</strong>策略，<strong>自己不会监控存入的key/value对是否过期，而是在获取key值时查看记录的时间戳，检查key/value对空间是否过期</strong>。这种策略不会在过期检测上浪费cpu资源。   </p>

                            
                        </div>
                    </div>
                </a>

                <div class="read-more clearfix">
                    <div class="more-left left">
                        
                        <span class="date">2015/10/25</span>
                        
                        
                    </div>
                    <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                    </div>
                </div>
            </div>
            <!-- article -->
            
            <div class="article">
                <a class="clearlink" href="14457412435105.html">
                    
                    <h1>---</h1>

                    <div class="a-content">
                        
                        <div class="a-content-text">
                            
                            <p>layout: post<br/>
title: <q>CDN</q><br/>
category: </p>

<h2 id="toc_0">tags: [<q>读文章</q>]</h2>

<p>{% include JB/setup %}</p>

<ul>
<li><p>A content delivery network or content distribution network is <strong>a system of computers containing copies of data placed at various nodes of a network</strong>. When properly designed and implemented, a CDN can improve access to the data it caches by increasing access bandwidth and redundancy and reducing access latency, Data content types often caches in CDNs including web objects, downloadable objects....</p></li>
<li><p>The capacity sum of strategically placed servers can be higher than the network backbone capacity. This can result in an impressive increase in the number of concurrent users. For instance, <strong>when there is a 10 Gbit/s network backbone and 200 Gbit/s central server capacity, only 10 Gbit/s can be delivered</strong>. But <strong>when 10 servers are moved to 10 edge locations, total capacity can be 10 10 Gbit/s</strong>.</p></li>
<li><p>Strategically placed edge servers decrease the load on interconnects, public peers, private peers and backbones, freeing up capacity and lowering delivery costs. It uses the same principle as above. Instead of loading all traffic on a backbone or peer link, a CDN can offload these by redirecting traffic to edge servers.</p></li>
<li><p>CDN generally deliver content over TCP and UDP connections.</p></li>
<li><p><strong>TCP throughput over a network is affected by both latency and packet loss</strong>. In order to reduce both of these parameters, <strong>CDNs traditionally place servers as close to the edge networks that users are on as possible</strong>. Theoretically the closer the content the faster the delivery, <strong>although network distance may not be the factor that leads to best performance</strong>. End users will likely experience less jitter, fewer network peaks and surges, and improved stream quality- especially in remote areas. The increased reliability allows a CDN operator to deliver HD quality content with high Quality of Service, low costs and low network load. <strong>Some providers also utilize TCP acceleration technology to further boost CDN’s performance and end-user experiences</strong>.</p></li>
<li><p>CDN nodes are usually deployed in multiple locations, often over multiple backbones. These nodes cooperate with each other to satisfy requests for content by end users, transparently moving content to optimize the delivery process. Optimization can take the form of reducing bandwidth costs, improving end-user performance (reducing page load times and improving user experience), or increasing global availability of content.</p></li>
<li><p><strong>Requests for content are typically algorithmically directed to nodes that are optimal in some way</strong>. When optimizing for performance, locations that are best for serving content to the user may be chosen. This may be measured by <strong>choosing locations that are the fewest hops, the fewest number of network seconds away from the requesting client, or the highest availability in terms of server performance</strong> (both current and historical), so as to optimize delivery across local networks. When optimizing for cost, locations that are least expensive may be chosen instead.</p></li>
<li><p>In an optimal scenario, these two goals tend to align, as servers that are close to the end user at the edge of the network may have an advantage in performance or cost. The edge network is grown outward from the origin/s by further acquiring (via purchase, peering, or exchange) co- location facilities, bandwidth and servers.</p></li>
<li><p>The Internet was designed according to the end-to-end principle. This principle keeps the core network relatively simple and moves the intelligence as much as possible to the network end-points: the hosts and clients. As a result the core network is specialized, simplified, and optimized to only forward data packets.</p></li>
<li><p>Content Delivery Networks augment the end-to-end transport network by distributing on it a variety of intelligent applications employing techniques designed to optimize content delivery. The resulting tightly integrated overlay uses web caching, server-load balancing, request routing, and content services.</p></li>
<li><p>Web caches store popular content on servers that have the greatest demand for the content requested. These shared network appliances reduce bandwidth requirements, reduce server load, and improve the client response times for content stored in the cache.</p></li>
<li><p>Server-load balancing uses one or more techniques including service based (global load balancing) or hardware based, known as a web switch, content switch, or multilayer switch to share traffic among a number of servers or web caches. Here the switch is assigned a single virtual IP address. Traffic arriving at the switch is then directed to one of the real web servers attached to the switch. This has the advantage of balancing load, increasing total capacity, improving scalability, and providing increased reliability by redistributing the load of a failed web server and providing server health checks.</p></li>
<li><p>A content cluster or service node can be formed using a layer 4-7 switch balance load across a number of servers or a number of web caches within the network.</p></li>
<li><p>Request routing directs client requests to the content source best able to serve the request. This may involve directing a client request to the service node that is closest to the client, or to the one with the most capacity.</p></li>
<li><p>CDNs use a variety of methods of content delivery including, but not limited to, manual asset coping, active web caches, and global hardware load balancers.</p></li>
<li><p><strong>Although peer-to-peer is not traditional CDN technology, it is increasingly used to deliver content to end users</strong>. P2P claims low cost and efficient distribution. Even though P2P actually generates more traffic than traditional client-server CDNs for the edge provider (because a<br/>
peer also uploads data instead of just downloading it) it’s welcome by parties running content delivery/distribution services. The real strength of P2P shows when one has to distribute data in high demand, like the latest episode of a television show or some sort of software patch/update in short period of time. One of the advantages of this is that the more people who download the same data, the more efficient P2P is for the provider, slashing the cost of the transit fees that a CDN provider has to pay to their upstream IP transit providers.</p></li>
</ul>

                            
                        </div>
                    </div>
                </a>

                <div class="read-more clearfix">
                    <div class="more-left left">
                        
                        <span class="date">2015/10/25</span>
                        
                        
                    </div>
                    <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                    </div>
                </div>
            </div>
            <!-- article -->
            


            <div class="row">
                <div class="large-6 columns">
                    <p class="text-left" style="padding-top:25px;">
                         <a href="all_25.html">&laquo; Prev Page</a> 
                    </p>
                </div>
                <div class="large-6 columns">
                    <p class="text-right" style="padding-top:25px;">
                         <a href="all_27.html">&raquo; Next Page</a> 
                    </p>
                </div>
            </div>
        </div>
    </div>
    <!-- large 8 -->

 <div class="large-4 medium-4 columns">
    <div class="hide-for-small">
        <div id="sidebar" class="sidebar">
            <div id="site-info" class="site-info">
                
                <h1>NathanCHEN</h1>

                <div class="site-des"></div>
                <div class="social">
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    <a class="rss" href="atom.xml" title="RSS">RSS</a>

                </div>
            </div>
            <div id="site-categories" class="side-item ">
                <div class="side-header">
                    <h2>Contact</h2>
                </div>
                <div class="side-content">
                    <ul class="posts-list">
                        <li class="post">
                            <p class="email-addr">tringchen AT gmail.com</p>

                            <p class="email-addr">江苏 · 南京</p>
                        </li>
                    </ul>
                </div>
            </div>
            <div id="site-categories" class="side-item ">
                <div class="side-header">
                    <h2>Categories</h2>
                </div>
                <div class="side-content">

                    <p class="cat-list">
                        
                        <a href="Java.html"><strong>Java</strong></a>
                        
                        <a href="JavaScript.html"><strong>JavaScript</strong></a>
                        
                        <a href="Ngnix.html"><strong>Ngnix</strong></a>
                        
                        <a href="tomcat.html"><strong>tomcat</strong></a>
                        
                        <a href="spring.html"><strong>spring</strong></a>
                        
                        <a href="RabbitMQ.html"><strong>RabbitMQ</strong></a>
                        
                        <a href="ELK.html"><strong>ELK</strong></a>
                        
                        <a href="TCP/IP.html"><strong>TCP/IP</strong></a>
                        
                        <a href="%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB.html"><strong>源码阅读</strong></a>
                        
                        <a href="others.html"><strong>others</strong></a>
                        
                        <a href="%E6%95%B0%E6%8D%AE%E5%BA%93.html"><strong>数据库</strong></a>
                        
                        <a href="PAXOS.html"><strong>PAXOS</strong></a>
                        
                        <a href="%E6%B7%B1%E5%85%A5%E5%88%86%E6%9E%90Java%20Web%E6%8A%80%E6%9C%AF%E5%86%85%E5%B9%95.html"><strong>深入分析Java Web技术内幕</strong></a>
                        
                    </p>


                </div>
            </div>

            <div id="site-categories" class="side-item">
                <div class="side-header">
                    <h2>Recent Posts</h2>
                </div>
                <div class="side-content">
                    <ul class="posts-list">
                        
                        
                        <li class="post">
                            <a href="14596982516208.html">StringBuilder在高性能场景下的正确用法</a>
                        </li>
                        
                        
                        
                        <li class="post">
                            <a href="14596964476354.html">分布式Unique ID的生成方法一览</a>
                        </li>
                        
                        
                        
                        <li class="post">
                            <a href="14596091370634.html">关于Java集合的小抄</a>
                        </li>
                        
                        
                        
                        <li class="post">
                            <a href="14596082686083.html">Java ArrayList工作原理及实现</a>
                        </li>
                        
                        
                        
                        <li class="post">
                            <a href="14594286280881.html">索引的相关知识</a>
                        </li>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                    </ul>
                </div>
            </div>
        </div>
        <!-- sidebar -->
    </div>
    <!-- hide for small -->
</div><!-- large 4 -->

</div><!-- row -->
 <div class="page-bottom clearfix">
    <div class="row">
        <p class="copyright">Copyright &copy; 2016
            Powered by <a target="_blank" href="http://www.mweb.im">MWeb</a>,&nbsp;
            Theme used <a target="_blank" href="http://github.com">GitHub CSS</a>.</p>
    </div>
</div>
</section>
</div>
</div>




<script src="asset/js/foundation.min.js"></script>
<script>
    $(document).foundation();
    function fixSidebarHeight() {
        var w1 = $('.markdown-body').height();
        var w2 = $('#sidebar').height();
        if (w1 > w2) {
            $('#sidebar').height(w1);
        }
        ;
    }
    $(function () {
        fixSidebarHeight();
    })
    $(window).load(function () {
        fixSidebarHeight();
    });

</script>





</body>
</html>
