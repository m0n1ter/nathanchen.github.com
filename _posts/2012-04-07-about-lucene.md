---
layout: post
title: "About Lucene"
category: 
tags: []
---
{% include JB/setup %}

1. 我们生活中的数据总体分为两种：结构化数据和非结构化数据
	- 结构化数据：指具有固定格式或有限长度的数据，如数据库、元数据等。
	- 非结构化数据：指不定长或无固定格式的数据，如邮件、word文档等。
	还有半结构化数据，如XML、HTML等

2. 按照数据的分类，搜索分成两种：
	- 对结构化数据的搜索：如对数据库的搜索，用SQL语句。再如对元数据的搜索，如利用windows搜索对文件名、类型，修改时间进行搜索等。
	- 对非结构化数据的搜索：利用Google可以搜索大量内容数据

3. 对非结构化数据也即对全文数据的搜索主要有两种方法：
	- 一种是顺序扫描法：比如要找内容包含某一个字符串的文件，就是一个文档一个文档的看，对于每一个文档，从头看到尾，如果此文档包含此字符串，则此文档为我们要找的文档，接着看下一个文件，直到扫描完所有的文件。

4. 对非结构化数据顺序扫描很慢，对结构化数据的扫描相对较快（由于结构化数据有一定的结构可以采取一定的搜索算法加快速度）。全文检索的基本思路，也即将非结构数据中的一部分信息提取出来，重新组织，使其变得有一定结构，然后对此有一定结构的数据进行搜索，从而打到搜索相对较快的目的。

5. 这部分从非结构化数据中提取出的然后重新组织的信息，我们称之为索引。

6. 全文搜索大体分两个过程，索引创建（indexing）和搜索索引（Search）
	- 索引创建：将现实世界中所有的结构化和非结构化数据提取信息，创建索引的过程。
	- 搜索索引：就是得到用户的查询请求，搜索创建的索引，然后返回结果的过程。

7. 由于从字符串到文件的映射是文件到字符串映射的反向过程，于是保存这种信息的索引成为反向索引。

8. 左边保存的是一系列字符串，称之为词典。
	每个字符串都指向包含此字符串的文档（Document）链表，此文档链表称为倒排表（Posting List）

9. 比如说，我们要寻找既包含字符串”lucene“又包含字符串”solr“的文档，我们只需要以下几步：
	- 取出包含字符串”lucene“的文档链表
	- 取出包含字符串”solr“的文档链表
	- 通过合并链表，找出既包含”lucene“又包含”solr“的文件

10. 全文检索的确加快了搜索的速度，但是多了索引的过程，两者加起来不一定比顺序扫描快多少。的确，加上索引的过程，全文检索不一定比顺序扫描快，尤其是在数据量小的时候更是如此。而对一个很大量的数据创建索引也是一个很慢的过程。然而两者还是有区别的，顺序萨摩是每次都要扫描，而创建索引的过程仅仅需要一次，以后便是一劳永逸的了。每次搜索，创建索引的过程不必经过，仅仅搜索创建好的索引就可以了。这也是全文搜索相对于顺序扫描的优势之一：一次索引，多次使用。

11. 全文检索的索引过程一般有一下几步：
	- 第一步：一些要索引的源文档（document）
	- 第二步：将源文档传给分词组件（Tokenizer）：分成单独的单词；去掉标点；去掉Stop word
	- 第三步：将得到的词元（Token）传给语言处理组件：变成小写；去掉复数之类的东西，去掉动词形式等
	- 第四步：建立字典，然后生成索引

	索引中包括：
	词	词在多少个文档中出现	词在各个文档中出现的次数

12. 在搜索的时候利用tf-idf计算出搜索结果排列顺序
	- 这个词在此文档中出现了多少次
	- 有多少文档包含这个词

	tf * log（文档的数量/df）

13. Lucene为了使信息的存储占用的空间更小，访问速度更快，采取了一些特殊的技巧。
a）当某个词和前一个词有共同的前缀的时候，后面的词仅仅保存前缀在词中的偏移（offset），以及除前缀以外的字符串（称为后缀）

14. 